# ЁЯЪА **Named Entity Recognition - NER** ЁЯЪА

### 1. **р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ** ЁЯУж
```python
%pip install -q datasets transformers[sentencepiece] simpletransformers scikit-learn
```
- **р╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Чр╕╡р╣Ир╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З:**
  - ЁЯПЧя╕П `datasets`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е
  - ЁЯдЧ `transformers`: р╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Вр╕нр╕З Hugging Face р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Вр╕бр╣Ар╕Фр╕е NLP
  - тЬи `simpletransformers`: р╕Чр╕│р╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Вр╕бр╣Ар╕Фр╕е Transformer р╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕вр╕Вр╕╢р╣Йр╕Щ
  - ЁЯУК `scikit-learn`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕ер╣Вр╕бр╣Ар╕Фр╕е

---

### 2. **р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е** ЁЯУВ
```python
import os
import zipfile

# р╕Бр╕│р╕лр╕Щр╕Фр╣Ар╕кр╣Йр╕Щр╕Чр╕▓р╕З
zip_path = "super-ai-ss-5-named-entity-recognition.zip"
extract_path = "super-ai-ss-5-named-entity-recognition"

# р╕Цр╣Йр╕▓р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М р╣Гр╕лр╣Йр╕Чр╕│р╕Бр╕▓р╕гр╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М
if not os.path.exists(extract_path):
    with zipfile.ZipFile(zip_path, 'r') as zip_ref:
        zip_ref.extractall(extract_path)

    # р╕Ир╕▒р╕Фр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Ър╕Зр╣Ир╕▓р╕в
    for split in ['train', 'eval', 'test']:
        split_path = os.path.join(extract_path, split)
        nested = os.path.join(split_path, split)
        if os.path.exists(nested):
            for fname in os.listdir(nested):
                os.rename(os.path.join(nested, fname), os.path.join(split_path, fname))
            os.rmdir(nested)
```
- **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Вр╕Др╣Йр╕Фр╕Чр╕│:**
  - ЁЯУж р╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М zip р╕Чр╕╡р╣Ир╕бр╕╡р╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е
  - ЁЯЧВя╕П р╕Ир╕▒р╕Фр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕бр╣Ир╣Гр╕лр╣Йр╣Ар╕гр╕╡р╕вр╕Ър╕Зр╣Ир╕▓р╕в
  - **р╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕Ър╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щ 3 р╕кр╣Ир╕зр╕Щ:**
    - ЁЯПЛя╕ПтАНтЩВя╕П `train`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е
    - ЁЯУЭ `eval`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Эр╕╢р╕Б
    - ЁЯзк `test`: р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ър╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в

---

### 3. **р╣Вр╕лр╕ер╕Фр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е** ЁЯФН
```python
from datasets import load_dataset

data_files = {
    "train": "super-ai-ss-5-named-entity-recognition/train/train.csv",
    "validation": "super-ai-ss-5-named-entity-recognition/eval/eval.csv",
    "test": "super-ai-ss-5-named-entity-recognition/test/test.csv"
}

dataset = load_dataset("csv", data_files=data_files)
dataset
```
- **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Вр╕Др╣Йр╕Фр╕Чр╕│:**
  - ЁЯУе р╣Гр╕Кр╣Йр╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡ `datasets` р╣Ар╕Юр╕╖р╣Ир╕нр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М CSV р╕Чр╕▒р╣Йр╕Зр╕кр╕▓р╕бр╕кр╣Ир╕зр╕Щ
  - ЁЯУК р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Вр╕лр╕ер╕Фр╕бр╕▓

---

### 4. **р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Бр╕ер╕░р╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е** ЁЯза
```python
from simpletransformers.ner import NERModel, NERArgs
import pandas as pd

# р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╕Эр╕╢р╕Бр╣Бр╕ер╕░р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ
train_df = pd.read_csv("super-ai-ss-5-named-entity-recognition/train/train.csv")
eval_df = pd.read_csv("super-ai-ss-5-named-entity-recognition/eval/eval.csv")

# р╕Бр╕│р╕лр╕Щр╕Фр╕Др╣Ир╕▓р╕Хр╣Ир╕▓р╕Зр╣Ж р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Вр╕бр╣Ар╕Фр╕е
model_args = NERArgs()
model_args.num_train_epochs = 3  # р╕Эр╕╢р╕Б 3 р╕гр╕нр╕Ъ
model_args.train_batch_size = 8  # р╕Вр╕Щр╕▓р╕Фр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕│р╕лр╕гр╕▒р╕Ър╕Эр╕╢р╕Бр╣Бр╕Хр╣Ир╕ер╕░р╕Др╕гр╕▒р╣Йр╕З
model_args.evaluate_during_training = True  # р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ьр╕ер╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Эр╕╢р╕Б
model_args.labels_list = list(train_df['labels'].unique())  # р╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕Вр╕нр╕Зр╣Ар╕нр╕Щр╕Чр╕┤р╕Хр╕╡

# р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е NER
model = NERModel(
    "bert",  # р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕Вр╕нр╕Зр╣Вр╕бр╣Ар╕Фр╕е
    "bert-base-multilingual-cased",  # р╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕е BERT р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕лр╕ер╕▓р╕вр╕ар╕▓р╕йр╕▓
    args=model_args,
    use_cuda=False  # р╣Др╕бр╣Ир╣Гр╕Кр╣Й GPU
)

# р╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕е
model.train_model(train_df, eval_data=eval_df)
```
- **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Вр╕Др╣Йр╕Фр╕Чр╕│:**
  - ЁЯЫая╕П р╣Гр╕Кр╣Й `simpletransformers` р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е NER р╣Бр╕Ър╕Ър╕Зр╣Ир╕▓р╕в
  - ЁЯМН р╣Ар╕ер╕╖р╕нр╕Бр╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕е **BERT р╕гр╕╕р╣Ир╕Щр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕лр╕ер╕▓р╕вр╕ар╕▓р╕йр╕▓ (multilingual)**
  - тЪЩя╕П р╕Бр╕│р╕лр╕Щр╕Фр╕Юр╕▓р╕гр╕▓р╕бр╕┤р╣Ар╕Хр╕нр╕гр╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж р╣Ар╕Кр╣Ир╕Щ:
    - ЁЯФД р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕нр╕Ър╕Бр╕▓р╕гр╕Эр╕╢р╕Б (`num_train_epochs`)
    - ЁЯУж р╕Вр╕Щр╕▓р╕Фр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е (`train_batch_size`)
    - ЁЯУК р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Эр╕╢р╕Б (`evaluate_during_training`)
  - ЁЯПЛя╕ПтАНтЩВя╕П р╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╕Фр╣Йр╕зр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕е training р╣Бр╕ер╕░р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Фр╣Йр╕зр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕е evaluation

---

### 5. **р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕бр╣Ар╕Фр╕ер╕Фр╣Йр╕зр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕Фр╕кр╕нр╕Ъ** ЁЯУК
```python
# р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Вр╕бр╣Ар╕Фр╕ер╕Фр╣Йр╕зр╕вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕Фр╕кр╕нр╕Ъ
test_df = pd.read_csv("super-ai-ss-5-named-entity-recognition/test/test.csv")
result, model_outputs, predictions = model.eval_model(test_df)
print(result)
```
- **р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Вр╕Др╣Йр╕Фр╕Чр╕│:**
  - ЁЯУе р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕Фр╕кр╕нр╕Ъ (test set)
  - ЁЯУИ р╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Вр╕нр╕Зр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╕Эр╕╢р╕Бр╕бр╕▓р╣Бр╕ер╣Йр╕з
  - ЁЯУв р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ р╣Ар╕Кр╣Ир╕Щ:
    - ЁЯОп р╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│ (accuracy)
    - ЁЯФН F1-score
    - ЁЯУМ Precision р╣Бр╕ер╕░ Recall

---
